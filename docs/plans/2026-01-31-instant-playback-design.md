# 즉석 재생 기능 설계

## 개요

연주한 내용을 자동으로 녹음하고 바로 다시 재생할 수 있는 기능입니다. 세션 내에서만 유지되며, 새로고침 시 초기화됩니다.

## 핵심 동작

### 자동 녹음
- 사용자가 첫 음을 연주하면 자동으로 녹음 시작
- 별도의 녹음 버튼 없이 항상 백그라운드에서 동작
- 녹음 중임을 나타내는 작은 인디케이터 표시 (빨간 점 등)

### 연주 구간 구분 (설정 가능)

| 모드 | 동작 | 기본값 |
|------|------|--------|
| 시간 기반 | 마지막 음 후 N초(기본 3초) 경과 시 자동 저장 | ✓ |
| 수동 구분 | "새 연주" 버튼으로 구분 | |
| 무한 연속 | 구분 없이 계속 녹음, 수동으로 구간 선택 | |

### 데이터 저장
- 각 음의 정보 저장: 음 높이, 시작 시간, 현재 설정(파형, 볼륨)
- 세션 내 메모리에 저장 (새로고침 시 초기화)

## UI 레이아웃

### 녹음 목록 영역 (하단 고정)

```
┌─────────────────────────────────────────┐
│  [컨트롤: 스케일, 옥타브, 파형, 볼륨]      │
├─────────────────────────────────────────┤
│                                         │
│            [건반 버튼 그리드]             │
│                                         │
├─────────────────────────────────────────┤
│  🔴 녹음 중                              │
│  ┌───────────────────────────────────┐  │
│  │ 14:32:05 (12초)  [▶][■][🗑]       │  │
│  │ 14:31:42 (8초)   [▶][■][🗑]       │  │
│  │ 14:30:15 (23초)  [▶][■][🗑]       │  │
│  └───────────────────────────────────┘  │
└─────────────────────────────────────────┘
```

### 목록 항목 구성
- 왼쪽: 녹음 시간 + 연주 길이
- 오른쪽: 재생(▶/⏸), 정지(■), 삭제(🗑) 버튼

### 반응형 처리
- 목록 높이 제한 (최대 150px), 초과 시 스크롤
- 모바일에서도 동일한 하단 배치 유지

## 데이터 구조

### 녹음 데이터

```javascript
{
  id: 1,                    // 고유 ID
  timestamp: "14:32:05",    // 녹음 시작 시간
  duration: 12.5,           // 연주 길이 (초)
  notes: [
    { semitone: 0, time: 0, waveform: "sine", volume: 0.5 },
    { semitone: 2, time: 0.3, waveform: "sine", volume: 0.5 },
    { semitone: 4, time: 0.6, waveform: "sine", volume: 0.5 },
    // ...
  ]
}
```

## 재생 로직

- 녹음된 시간 간격 그대로 `setTimeout`으로 음 재생
- 재생 중 일시정지: 타이머 일시 중단, 현재 위치 저장
- 정지: 모든 타이머 취소, 위치 초기화

## 설정 UI

- 기존 컨트롤 영역에 설정 버튼(⚙️) 추가
- 클릭 시 녹음 모드 선택 옵션 표시 (시간 기반 / 수동 구분 / 무한 연속)
- 시간 기반 모드 선택 시 대기 시간 설정 (기본 3초)

## 향후 확장

이 기능은 다음 단계의 기반이 됩니다:
- **저장 후 재사용**: 녹음 데이터를 로컬 스토리지에 저장
- **공유**: 녹음 데이터를 파일로 내보내기
