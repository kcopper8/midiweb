# 계이름 연주기 - 기능 스펙 문서

## 개요

웹 브라우저에서 동작하는 단일 페이지 음악 연주 도구입니다. Web Audio API를 사용하여 실시간으로 음을 생성하며, 다양한 스케일과 음색을 지원합니다.

## 기술 스택

| 항목 | 기술 |
|------|------|
| 마크업 | HTML5 |
| 스타일 | CSS3 (CSS Grid, Flexbox) |
| 스크립트 | Vanilla JavaScript (ES6+) |
| 오디오 | Web Audio API |

## 기능 명세

### 1. 음 재생

#### 1.1 기본 동작
- 버튼 클릭/터치 시 해당 음이 재생됩니다
- 기준음: C4 (261.63Hz)
- 음 길이: 0.8초 (페이드아웃 포함)

#### 1.2 주파수 계산
```
frequency = baseFrequency × 2^(semitone/12)
```

#### 1.3 지원 음역
- 최저음: C4 (261.63Hz)
- 최고음: C5 (523.25Hz)
- 범위: 1 옥타브

### 2. 스케일 선택

6종의 스케일을 지원합니다.

| 스케일 | 음 개수 | 반음 간격 | 설명 |
|--------|---------|-----------|------|
| Major (장조) | 8 | 0, 2, 4, 5, 7, 9, 11, 12 | 밝고 경쾌한 느낌 |
| Minor (단조) | 8 | 0, 2, 3, 5, 7, 8, 10, 12 | 어둡고 슬픈 느낌 |
| Pentatonic (5음계) | 6 | 0, 2, 4, 7, 9, 12 | 동양적, 민속 음악 |
| Blues | 7 | 0, 3, 5, 6, 7, 10, 12 | 재즈/블루스 느낌 |
| Chromatic (반음계) | 13 | 0~12 (모든 반음) | 모든 음 포함 |
| Dorian | 8 | 0, 2, 3, 5, 7, 9, 10, 12 | 재즈 모드 |

### 3. 파형 선택

4종의 오실레이터 파형을 지원합니다.

| 파형 | 영문명 | 소리 특성 |
|------|--------|-----------|
| 사인파 | Sine | 부드럽고 순수한 소리 (기본값) |
| 사각파 | Square | 8비트 게임, 레트로 느낌 |
| 삼각파 | Triangle | 플루트, 클라리넷 느낌 |
| 톱니파 | Sawtooth | 날카롭고 풍부한 배음 |

### 4. 볼륨 조절

- 범위: 0% ~ 100%
- 기본값: 50%
- 조절 방식: 슬라이더 (range input)
- 실시간 표시: 현재 볼륨 퍼센트

### 5. UI/UX

#### 5.1 레이아웃
- 반응형 CSS Grid 레이아웃
- 화면 가로 전체를 채우는 버튼 배열
- 스케일 변경 시 그리드 열 개수 동적 조절

#### 5.2 디자인 테마
- 스타일: 미니멀 모던
- 배경색: #fafafa (밝은 회색)
- 버튼 배경: #fff (흰색)
- 활성 상태: #333 (어두운 회색)
- 그림자 효과: box-shadow 적용

#### 5.3 인터랙션
- 호버: 그림자 강화
- 클릭/터치: 배경색 반전, 글자색 변경
- 트랜지션: 0.15초 ease

#### 5.4 컨트롤 UI
- 스케일 선택: 토글 버튼 그룹
- 파형 선택: 토글 버튼 그룹
- 볼륨: 슬라이더 + 퍼센트 표시

### 6. 입력 지원

#### 6.1 마우스
- mousedown: 음 재생 시작, 활성 상태 표시
- mouseup: 활성 상태 해제
- mouseleave: 활성 상태 해제

#### 6.2 터치 (모바일)
- touchstart: 음 재생 시작, 활성 상태 표시
- touchend: 활성 상태 해제
- preventDefault로 더블탭 줌 방지

#### 6.3 키보드
키보드 좌측 중단 행(A~L)을 사용하여 연주할 수 있습니다.

| 키 | 음 (Major 기준) | 키 | 음 |
|----|-----------------|----|----|
| A | 도 (C4) | G | 솔 (G4) |
| S | 레 (D4) | H | 라 (A4) |
| D | 미 (E4) | J | 시 (B4) |
| F | 파 (F4) | K | 도 (C5) |

Chromatic 스케일용 추가 키: `L`, `;`, `'`, `\`, `]`

- keydown: 음 재생 시작, 활성 상태 표시
- keyup: 활성 상태 해제
- 키 반복(repeat) 방지 처리
- 각 버튼에 단축키 힌트 표시

### 7. 음 표기

각 버튼에 두 가지 표기를 함께 표시합니다.

| 표기 | 예시 | 설명 |
|------|------|------|
| 한글 계이름 | 도, 레, 미... | 주 표시 (큰 글씨) |
| 영문 음이름 | C4, D4, E4... | 보조 표시 (작은 글씨) |

## 브라우저 호환성

- Chrome (권장)
- Firefox
- Safari
- Edge
- 모바일 브라우저 (iOS Safari, Android Chrome)

## 파일 구조

```
midiweb/
├── index.html    # 단일 파일 (HTML + CSS + JS)
└── SPEC.md       # 기능 스펙 문서
```

## 향후 확장 가능 기능

- [x] 키보드 단축키 지원
- [ ] 옥타브 확장 (2~3 옥타브)
- [ ] 연주 녹음/재생
- [ ] 시각적 애니메이션 효과
- [ ] 사용자 정의 스케일
- [ ] MIDI 입력 지원
